# Компьютерное зрение "Проект по определению возраста человека по фотографии"
Описание проекта: Сетевой супермаркет внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы: Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы; Контролировать добросовестность кассиров при продаже алкоголя.

Цель: Построить модель, которая по фотографии определит приблизительный возраст человека, используя набор фотографий людей с указанием возраста.

Задачи проекта:
Провести исследовательский анализ набора фотографий: построить график возраста.
Подготовить данные к обучению, разделить на выборки.
Обучить нейронную сеть и рассчитать её качество на разных количествах эпох.

Навыки и инструменты: обработка изображений, нейронные сети, Python, Keras

Выводы: 

Поскольку в изначальном датасете было 7591, выборки были разбиты на 5694 в обучающей и 1897 в тестовой. В связи с особенностями фотографий, проанализированных из случайной выборки, из всех вариантов аугментации был выбран горизонтальный флип, который был применен только к обучающей выборке. Модель сверточной нейронной сети, построенной на ResNet50 с 4 слоями, была обучена дважды на 5 эпохах с результатом 4.4 на тренировочной и 6.97 на тестовой и на 10 эпохах с 2.56 на тренировочной и 5.91 на тестовой. 

Данные по возрасту в датасете распределились следующим образом: наибольшее число приходится на 26 лет и за ним на 30, есть средний пик в районе до 2 лет потом идет на спад и пик в 6-7, когда все идут в школу, дальше снижение и потом 12 начинается постепенный рост числа фото, когда человек делает уже много селфи и в том числе фотографии с друзьями, больше всего фотографий приходится на период 16 до 40 лет, потом число идет на спад, средний пик также после сорока в 50, далее небольшие пики приходятся на юбилейные даты. То в этом ключе полученная погрешность в 6 лет не так критична для основного массива фотографий. Так как по выборке случайных фотографий мы определили, что ракурсы на них самые разные, некоторые фотографии отсканированы неровно и скорее всего к ним имеет смысл применить аугментацию, чаще горизонтальный флип. Какие-то кадры сделаны в профиль, что может в ряде случаев дать погрешности при определении возраста, на каких-то фотографиях лицо частично закрыто, либо не хватает освещения, что также повлияет на результат обучения. В то же время выборка содержит фотографии людей различных национальностей, а в среднем, люди точнее определяют возраст в рамках своей национальности, а в чужой могут быть не точны. Поэтому получившаяся модель, которая имеет погрешность всего в 5,9 лет в ряде случаев сможет спрогнозировать лучше среднестатистического человека. 

В отношении улучшения модели, можно поэкспериментировать с увеличением числа эпох, а также добавлением других вариантов аугментации, например, поворота. Поскольку оптимайзер и так был выбран в самом минимальном значении, то его изменять в сторону увеличения можно лишь, если увеличить объем датасета больше, чем в два раза, что потребует большего времени для обучения, но может дать большую точность. С другой стороны, если время обучения не является важным критерием, то лучше оставить оптимайзер такой величиной.
